"0","#expand covariates by transition"
"0","mstate.data.expanded<-expand.covs(mstate.data,covs = names(mstate.data)[!names(mstate.data)%in%c(""id"",""from"",""to"",""trans"",""Tstart"",""Tstop"",""time"",""status"",""strata"",""type"")])"
"0","mstate.data.expanded<-mstate.data.expanded[!names(mstate.data.expanded)%in%setdiff(names(mstate.data),c(""id"",""from"",""to"",""trans"",""Tstart"",""Tstop"",""time"",""status"",""strata"",""type""))]"
"0",""
"0",""
"0","#Objects and functions to create the 'groups' argument of coxrfx"
"0","names_list<-list(mutations=mutation_vars,clinical=all_clinical_vars)"
"0","stratum_fun<-function(x){"
"0","  strsplit_length<-length(strsplit(x,""[.]"")[[1]])"
"0","  as.numeric(strsplit(x,""[.]"")[[1]][strsplit_length])"
"0","}"
"0",""
"0","group_function<-function(x){"
"0","  stratum<-stratum_fun(x)"
"0","  if(stratum%in%c(3)) return(paste0(""single_group_"",stratum))"
"0","  string_split<-strsplit(x,""[.]"")[[1]]"
"0","  string_split_length<-length(string_split)"
"0","  x<-paste0(string_split[-string_split_length],collapse = ""."")"
"0","  paste0(names(names_list)[sapply(names_list, function(y,x) x%in%y, x=x)],""_"",stratum)"
"0","}"
"0",""
"0","#argument 'groups' of coxrfx"
"0","groups<-sapply(names(mstate.data.expanded)[!names(mstate.data.expanded)%in%c(""id"",""from"",""to"",""trans"",""Tstart"",""Tstop"",""time"",""status"",""strata"",""type"")],group_function)"
"0",""
"0","#argument 'Z' of coxrfx"
"0","Z<-mstate.data.expanded[!names(mstate.data.expanded)%in%c(""id"",""from"",""to"",""trans"",""Tstart"",""Tstop"",""time"",""status"",""type"")]"
"0",""
"0","#argument 'surv' of coxrfx"
"0","surv<-Surv(mstate.data.expanded$time,mstate.data.expanded$status)"
"0",""
"0","#fit random effects model"
"0","coxrfx_object<-CoxRFX(Z,surv,groups,max.iter = 400)"
